@{
	ViewData["Title"] = "Start Chatting";
}


<div class="alert alert-success" id="userActivityInfo" style="display: none; text-align: center;">
</div>
<div class="row">
	<div class="col-md-3 col-log-3">
		<div class="index-card">
			<div>
				<h3>Welcome</h3>
				<br />
				<input type="text" placeholder="User Name" class="form-control" id="userName" />
				<br />
				<button id="joinBtn" type="button" class="btn btn-light btn-outline-dark">Start Chatting</button>
			</div>
		</div>
		<br />
		<br />
		<div class="index-card">
			<div>
				<h3>Create Room</h3>
				<br />
				<input type="text" placeholder="Room Name" class="form-control" id="roomName" />
				<br />
				<button type="button" class="btn btn-light btn-outline-dark">Add Room</button>
			</div>
		</div>
	</div>
	<div class="col-md-6 col-lg-6" style="background-color:lavender;">
		<br />
		<div style="height: 60%; background-color: white;" class="overflow-auto form-control">
			HELLO
		</div>
		<br />
		<div>
			<label for="exampleFormControlTextarea1" class="form-label">Write your message...</label>
			<textarea class="form-control" id="exampleFormControlTextarea1" rows="2"></textarea>
			<br />
			<div style="display:flex; justify-content: right;">
				<button type="button" class="btn btn-light btn-outline-dark">Send</button>
			</div>
		</div>
	</div>
	<div class="col-md-3 col-lg-3">
		<h3>Online Users</h3>
		<ul class="list-group">
			<li class="list-group-item">Cras justo odio</li>
			<li class="list-group-item">Dapibus ac facilisis in</li>
			<li class="list-group-item">Morbi leo risus</li>
			<li class="list-group-item">Porta ac consectetur ac</li>
			<li class="list-group-item">Vestibulum at eros</li>
		</ul>
		<br />
		<h3>Active Rooms</h3>
		<div class="list-group" id="roomList" role="tablist">
			<a href="#" class="list-group-item list-group-item-action" data-toggle="list" role="tab">Item 1</a>
			<a href="#" class="list-group-item list-group-item-action" data-toggle="list" role="tab">Item 2</a>
			<a href="#" class="list-group-item list-group-item-action" data-toggle="list" role="tab">Item 3</a>
		</div>
	</div>
</div>

@section Scripts {
	<script src="~/lib/microsoft/signalr/dist/browser/signalr.js"></script>
	<script src="~/lib/microsoft/signalr/dist/browser/signalr.min.js"></script>
	<script>
		$(document).ready(() => {
			const hubConnection = new signalR.HubConnectionBuilder().withUrl("https://localhost:44327/chathub").build();

			hubConnection.start();

			$("#joinBtn").click(() => {
				const userName = $("#userName").val();
				hubConnection.invoke("GetUserName", userName).catch(error => console.log(error));
			});

			hubConnection.on("userJoined", userName => {
				$("#userActivityInfo").html(userName + " has just joined!")
				$("#userActivityInfo").fadeIn(5000, () => {
					setTimeout(() => {
						$("#userActivityInfo").fadeOut(2000);
					}, 2000);
				})
			});

			$('#roomList a').on('click', function (e) {
				e.preventDefault();
				$(this).toggleClass('active');
			});
		});
	</script>
}