@{
	ViewData["Title"] = "Start Chatting";
}

<div class="text-center">
	<div class="alert alert-success" id="userActivityInfo" style="display: none;">
	</div>
	<h1 class="display-4">Welcome</h1>
	<input type="text" placeholder="User Name" id="userName" />
	<button id="joinBtn">Start Chatting</button>
</div>

@section Scripts {
	<script src="~/lib/microsoft/signalr/dist/browser/signalr.js"></script>
	<script src="~/lib/microsoft/signalr/dist/browser/signalr.min.js"></script>
	<script>
		$(document).ready(() => {
			const hubConnection = new signalR.HubConnectionBuilder().withUrl("https://localhost:44327/chathub").build();

			hubConnection.start();

			$("#joinBtn").click(() => {
				const userName = $("#userName").val();
				hubConnection.invoke("GetUserName", userName).catch(error => console.log(error));
			});

			hubConnection.on("userJoined", userName => {
				$("#userActivityInfo").html(userName + " has joined!")
				$("#userActivityInfo").fadeIn(5000, () => {
					setTimeout(() => {
						$("#userActivityInfo").fadeOut(2000);
					}, 2000);
				})
			});
		});
	</script>
}